class AudioPlayer{#t;#e=[];#n=0;currentState="pause";callback;constructor(t){this.#t=new Audio,this.callback=t,this.#s()}#s(){this.#t.onended=()=>{this.currentState="ended",this.callback(this.currentState),this.next()},this.#t.onpause=()=>{this.currentState="pause",this.callback("pause")},this.#t.onerror=()=>{this.currentState="error",this.callback(this.currentState,this.#t.error)},this.#t.onloadstart=()=>{this.currentState="loading",this.callback(this.currentState)},this.#t.onplaying=()=>{this.currentState="play",this.callback(this.currentState)}}previous(){this.#n--,this.#n<0&&(this.#n=this.#e.length-1),this.play(this.#e[this.#n],this.#e)}async play(t=null,e=null){this.#e=e||this.#e,this.currentTrack=t||this.currentTrack,this.#t.paused||this.#t.pause();try{this.#t.src=this.#e[this.#n].url,await this.#t.play()}catch(t){return this.currentState="error",!1}}pause(){this.#t.pause()}next(){this.#n++,this.#n>=this.#e.length&&(this.#n=0),this.play(this.#e[this.#n],this.#e)}get currentTrack(){return this.#e[this.#n]}set currentTrack(t){for(let e=0;e<this.#e.length;e++){if(this.#e[e].id===t.id){this.#n=e;break}}}get volume(){return this.#t.volume}set volume(t){this.#t.volume=t/100}get time(){}set time(t){}}class Component{element;callback;SPEED=0;constructor(t=null,e=(()=>{})){this.element=document.querySelector(t),this.callback=e,this.SPEED=parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--transition-speed").replace(/(ms|s)/g,""))}setElement(t){this.element=t}get displayed(){return"initial"===this.element.style.display}set displayed(t){let e;e=t?"initial":"none",this.element.style.display=e}}class Button extends Component{constructor(t,e){super(t,e),this.element&&(this.element.onclick=()=>this.callback())}setElement(t){super.setElement(t),this.element.onclick=()=>this.callback()}get text(){return this.element.querySelector("label").innerText}set text(t){return this.element.querySelector("label").innerText=t}get color(){return this.element.querySelector("label").style.color}set color(t){return this.element.querySelector("label").style.color=t}}class ToggleButton extends Button{#i;#r=0;constructor(t,e){super(t,e),this.#i=this.element.children,this.toggle(0)}toggle(t=null){this.#i[this.#r].style.display="none",null!==t?this.#r=t:(this.#r++,this.#r>=this.#i.length&&(this.#r=0)),this.#i[this.#r].style.display="block"}}class Info extends Component{#a;#l;#o=!1;constructor(t,e){super(t,e),this.#a=this.element.querySelector("#info-container"),this.#l=new ToggleButton("#info-button",(()=>{this.#o?this.close():this.open(),this.callback(this.#o)}))}open(){this.#o||(this.#a.style.transform="scaleY(1)",this.#l.toggle(1),this.#o=!0)}close(){this.#o&&(this.#a.style.transform="scaleY(0)",this.#l.toggle(0),this.#o=!1)}updata(t){this.#l.text=t.name,this.#l.color="error"===t.type?"var(--error-color)":"var(--color-yellow)"}}class ListButton extends Button{#u;constructor(t,e){super(null,e),this.#u=t;const n=document.createElement("div"),s=document.querySelector(".list-item").content.cloneNode(!0);if(s.querySelector("label").innerText=this.#u.name,n.appendChild(s),this.setElement(n.children[0]),"folder"===t.type){n.querySelector(".toggle").children[0].style.display="initial"}}}class Controller extends Component{currentState="pause";#c;#h;#p;constructor(t,e){super(t,e),this.#c=new Button("#previous-button",(()=>{this.callback("previous")})),this.#p=new Button("#next-button",(()=>{this.callback("next")})),this.#h=new ToggleButton("#action-button",(()=>{"loading"!==this.currentState&&("pause"===this.currentState?this.callback("play"):this.callback("pause"))}))}setState(t){this.currentState=t;let e=0;switch(this.currentState){case"play":e=1;break;case"pause":e=0;break;case"loading":e=2;break;case"error":e=3}this.#h.toggle(e)}}class RangeBar extends Component{#d;#m;constructor(t=null,e){super(t,e),this.#d=this.element.querySelector("input[type='range']"),this.#m=this.element.querySelector(".range-bar"),this.#d.oninput=()=>{const t=this.#d.value;this.#m.style.transform=`scaleX(${t/100})`,this.callback(this.value)}}get value(){return parseFloat(this.#d.value)}set value(t){this.#m.style.transform=`scaleX(${value/100})`}}class Menu extends Component{#g;#y;#k;#b;#B;#x=!1;constructor(t,e){super(t,e),this.#k=new ToggleButton("#menu-button",(()=>{this.#x?this.close():this.open()})),this.#b=new Button("#menu-back-button",(()=>{this.#f(this.#y.children.length-1)})),this.#y=this.element.querySelector("#menu-container")}#S(t){const e=document.createElement("ul");t.forEach((t=>{const n=new ListButton(t,(()=>{"folder"===t.type?this.#S(t.children):this.callback(t)}));e.appendChild(n.element)})),this.#B&&(this.#B.style.transform="translateX(-100%)"),this.#y.appendChild(e),this.#B=e,requestAnimationFrame((()=>{this.#B.style.transform="translateX(0)"})),this.#b.displayed=this.#y.children.length>1}#f(t=null){if(null!==t){const e=this.#y.children[t];this.#y.removeChild(e),this.#B=this.#y.children[this.#y.children.length-1],this.#B.style.transform="translateX(0)"}else this.#y.innerHTML="",this.#B=null;this.#b.displayed=this.#y.children.length>1}open(){this.#k.toggle(1),this.#y.style.transform="scaleY(1)",this.callback({type:"opening"}),setTimeout((()=>{this.#S(this.#g)}),this.SPEED),this.#x=!0}close(){this.#k.toggle(0),this.#f(),this.#y.style.transform="scaleY(0)",this.#x=!1}get data(){return this.#g}set data(t){this.#g=t}}let t;let e,n,s,i,r,a;window.onload=async()=>{await l("https://inexpensive-relieved-chartreuse.glitch.me/"),u(),o()};const l=async e=>{const n=await fetch(e),s=await n.json();t=[...s,{type:"open",name:"open"},{type:"reset",name:"reset"}]},o=()=>{a=new AudioPlayer(((t,s)=>{if(n.setState(t),"error"===t)e.update({name:a.currentTrack.name,type:t,error:s});"error"!==t&&e.update}))},u=()=>{e=new Info("#info",(()=>{})),n=new Controller("#controller",(t=>{switch(t){case"play":a.currentTrack?a.play():r.open();break;case"pause":a.pause();break;case"next":a.next();break;case"previous":a.previous()}})),s=new RangeBar("#scrubb",(()=>{})),i=new RangeBar("#volume",(t=>{a.volume=t})),r=new Menu("#menu",(async n=>{switch(n.type){case"opening":e.close();break;case"music":case"file":r.close(),await a.play(n,c(t,n.id));break;case"open":l.click()}})),r.data=t;const l=document.querySelector("#file-input");l.onchange=()=>{}},c=(t,e)=>{let n=null;for(let s=0;s<t.length;s++){const i=t[s];if(i.children?n=c(i.children,e):i.id===e&&(n=t),n)break}return n};